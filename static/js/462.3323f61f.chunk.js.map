{"version":3,"file":"static/js/462.3323f61f.chunk.js","mappings":"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","sources":["services/TrainingPlanAIService.validators.js"],"sourcesContent":["/**\n * Validation Functions for TrainingPlanAIService\n * \n * These validators can be called at key points to catch regressions:\n * - After parsing AI plan\n * - After transforming to dashboard format\n * - Before saving to Firestore\n */\n\n/**\n * Validate that workouts were parsed correctly\n */\nexport function validateWorkoutsParsed(weeks) {\n  const errors = [];\n  \n  weeks.forEach((week, index) => {\n    if (!week.workouts || week.workouts.length === 0) {\n      errors.push(`Week ${week.weekNumber || index + 1} has 0 workouts - parsing may have failed`);\n    }\n  });\n  \n  if (errors.length > 0) {\n    console.error('❌ WORKOUT PARSING VALIDATION FAILED:', errors);\n    return { valid: false, errors };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that hard days have hard workouts\n */\nexport function validateHardDays(weeks, qualityDays) {\n  if (!qualityDays || qualityDays.length === 0) return { valid: true };\n  \n  const errors = [];\n  \n  weeks.forEach(week => {\n    week.workouts.forEach(workout => {\n      if (qualityDays.includes(workout.day)) {\n        const descLower = (workout.description || '').toLowerCase();\n        const isHardWorkout = descLower.includes('tempo') || \n                             descLower.includes('interval') || \n                             descLower.includes('hill') ||\n                             descLower.includes('speed') ||\n                             workout.workoutType === 'tempo' ||\n                             workout.workoutType === 'interval' ||\n                             workout.workoutType === 'hill';\n        const isRest = descLower.includes('rest') || workout.type === 'rest';\n        const isEasy = descLower.includes('easy') && !isHardWorkout;\n        \n        if (isRest || (isEasy && !isHardWorkout)) {\n          errors.push(`Week ${week.weekNumber}: ${workout.day} is a hard day but has ${workout.description}`);\n        }\n      }\n    });\n  });\n  \n  if (errors.length > 0) {\n    console.error('❌ HARD DAYS VALIDATION FAILED:', errors);\n    return { valid: false, errors };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that rest days are actually rest\n */\nexport function validateRestDays(weeks, restDays) {\n  if (!restDays || restDays.length === 0) return { valid: true };\n  \n  const errors = [];\n  \n  weeks.forEach(week => {\n    week.workouts.forEach(workout => {\n      if (restDays.includes(workout.day)) {\n        const descLower = (workout.description || '').toLowerCase();\n        const isHardWorkout = descLower.includes('tempo') || \n                             descLower.includes('interval') || \n                             descLower.includes('hill') ||\n                             descLower.includes('speed');\n        const isRest = descLower.includes('rest') || workout.type === 'rest';\n        \n        if (isHardWorkout && !isRest) {\n          errors.push(`Week ${week.weekNumber}: ${workout.day} is a rest day but has hard workout: ${workout.description}`);\n        }\n      }\n    });\n  });\n  \n  if (errors.length > 0) {\n    console.error('❌ REST DAYS VALIDATION FAILED:', errors);\n    return { valid: false, errors };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that RunEQ miles are preserved (not converted to actual bike miles)\n */\nexport function validateRunEQMiles(weeks) {\n  const errors = [];\n  \n  weeks.forEach(week => {\n    week.workouts.forEach(workout => {\n      if (workout.type === 'bike' || (workout.description || '').toLowerCase().includes('runeq')) {\n        const desc = workout.description || '';\n        const hasRunEQ = desc.match(/runeq/i);\n        const hasActualMiles = desc.match(/\\d+\\s*(?:mile|miles).*cyclete/i) && !hasRunEQ;\n        \n        if (hasActualMiles) {\n          errors.push(`Week ${week.weekNumber}: ${workout.day} bike workout shows actual miles instead of RunEQ: ${desc}`);\n        }\n      }\n    });\n  });\n  \n  if (errors.length > 0) {\n    console.error('❌ RUNEQ MILES VALIDATION FAILED:', errors);\n    return { valid: false, errors };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that long runs show distance, not duration\n */\nexport function validateLongRunDistance(weeks) {\n  const errors = [];\n  \n  weeks.forEach(week => {\n    week.workouts.forEach(workout => {\n      if (workout.type === 'longRun' || (workout.description || '').toLowerCase().includes('long run')) {\n        const desc = workout.description || '';\n        const hasDuration = desc.match(/\\d+-\\d+\\s*(?:minutes?|min)/i);\n        const hasDistance = desc.match(/(\\d+(?:\\.\\d+)?)\\s*(?:miles?|mi)\\b/i);\n        \n        if (hasDuration && !hasDistance) {\n          errors.push(`Week ${week.weekNumber}: ${workout.day} long run shows duration instead of distance: ${desc}`);\n        }\n        \n        // Also check the distance property\n        if (!workout.distance || workout.distance === 0) {\n          errors.push(`Week ${week.weekNumber}: ${workout.day} long run missing distance property`);\n        }\n      }\n    });\n  });\n  \n  if (errors.length > 0) {\n    console.error('❌ LONG RUN DISTANCE VALIDATION FAILED:', errors);\n    return { valid: false, errors };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that Week 1 starts on the correct date\n */\nexport function validateWeek1StartDate(planOverview, expectedStartDate) {\n  if (!planOverview || !planOverview.startDate) {\n    return { valid: false, errors: ['Plan overview missing startDate'] };\n  }\n  \n  if (expectedStartDate && planOverview.startDate !== expectedStartDate) {\n    return { \n      valid: false, \n      errors: [`Week 1 start date mismatch: expected ${expectedStartDate}, got ${planOverview.startDate}`] \n    };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate that total weeks matches expected\n */\nexport function validateTotalWeeks(planOverview, expectedWeeks) {\n  if (!planOverview || !planOverview.totalWeeks) {\n    return { valid: false, errors: ['Plan overview missing totalWeeks'] };\n  }\n  \n  if (expectedWeeks && planOverview.totalWeeks !== expectedWeeks) {\n    return { \n      valid: false, \n      errors: [`Total weeks mismatch: expected ${expectedWeeks}, got ${planOverview.totalWeeks}`] \n    };\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Run all validations\n */\nexport function validateTrainingPlan(plan, userProfile) {\n  const results = {\n    valid: true,\n    errors: []\n  };\n  \n  if (!plan || !plan.weeks) {\n    return { valid: false, errors: ['Plan or weeks missing'] };\n  }\n  \n  // Validate workouts parsed\n  const workoutsResult = validateWorkoutsParsed(plan.weeks);\n  if (!workoutsResult.valid) {\n    results.valid = false;\n    results.errors.push(...workoutsResult.errors);\n  }\n  \n  // Validate hard days - check both qualityDays and hardSessionDays for backward compatibility\n  const qualityDays = userProfile?.qualityDays || userProfile?.hardSessionDays || [];\n  if (qualityDays.length > 0) {\n    const hardDaysResult = validateHardDays(plan.weeks, qualityDays);\n    if (!hardDaysResult.valid) {\n      results.valid = false;\n      results.errors.push(...hardDaysResult.errors);\n    }\n  }\n  \n  // Validate rest days\n  if (userProfile?.restDays) {\n    const restDaysResult = validateRestDays(plan.weeks, userProfile.restDays);\n    if (!restDaysResult.valid) {\n      results.valid = false;\n      results.errors.push(...restDaysResult.errors);\n    }\n  }\n  \n  // Validate RunEQ miles\n  const runEQResult = validateRunEQMiles(plan.weeks);\n  if (!runEQResult.valid) {\n    results.valid = false;\n    results.errors.push(...runEQResult.errors);\n  }\n  \n  // Validate long run distance\n  const longRunResult = validateLongRunDistance(plan.weeks);\n  if (!longRunResult.valid) {\n    results.valid = false;\n    results.errors.push(...longRunResult.errors);\n  }\n  \n  // Validate Week 1 start date\n  if (plan.planOverview && userProfile?.startDate) {\n    const startDateResult = validateWeek1StartDate(plan.planOverview, userProfile.startDate);\n    if (!startDateResult.valid) {\n      results.valid = false;\n      results.errors.push(...startDateResult.errors);\n    }\n  }\n  \n  // Validate total weeks\n  if (plan.planOverview && userProfile?.raceDate) {\n    const raceDate = new Date(userProfile.raceDate);\n    const startDate = new Date(userProfile.startDate || new Date());\n    const msPerWeek = 7 * 24 * 60 * 60 * 1000;\n    const expectedWeeks = Math.ceil((raceDate.getTime() - startDate.getTime()) / msPerWeek);\n    \n    const weeksResult = validateTotalWeeks(plan.planOverview, expectedWeeks);\n    if (!weeksResult.valid) {\n      results.valid = false;\n      results.errors.push(...weeksResult.errors);\n    }\n  }\n  \n  if (results.valid) {\n    console.log('✅ All training plan validations passed');\n  } else {\n    console.error('❌ Training plan validation failed:', results.errors);\n  }\n  \n  return results;\n}\n\n\n\n\n"],"names":["validateTrainingPlan","plan","userProfile","results","valid","errors","weeks","workoutsResult","forEach","week","index","workouts","length","push","concat","weekNumber","console","error","validateWorkoutsParsed","qualityDays","hardSessionDays","hardDaysResult","workout","includes","day","descLower","description","toLowerCase","isHardWorkout","workoutType","isRest","type","isEasy","validateHardDays","restDays","restDaysResult","validateRestDays","runEQResult","desc","hasRunEQ","match","validateRunEQMiles","longRunResult","hasDuration","hasDistance","distance","validateLongRunDistance","planOverview","startDate","startDateResult","expectedStartDate","raceDate","Date","msPerWeek","expectedWeeks","Math","ceil","getTime","weeksResult","totalWeeks","validateTotalWeeks","log"],"sourceRoot":""}