{"version":3,"file":"static/js/462.0f724cb3.chunk.js","mappings":"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","sources":["services/TrainingPlanAIService.validators.js"],"sourcesContent":["/**\r\n * Validation Functions for TrainingPlanAIService\r\n * \r\n * These validators can be called at key points to catch regressions:\r\n * - After parsing AI plan\r\n * - After transforming to dashboard format\r\n * - Before saving to Firestore\r\n */\r\n\r\n/**\r\n * Validate that workouts were parsed correctly\r\n */\r\nexport function validateWorkoutsParsed(weeks) {\r\n  const errors = [];\r\n  \r\n  weeks.forEach((week, index) => {\r\n    if (!week.workouts || week.workouts.length === 0) {\r\n      errors.push(`Week ${week.weekNumber || index + 1} has 0 workouts - parsing may have failed`);\r\n    }\r\n  });\r\n  \r\n  if (errors.length > 0) {\r\n    console.error('❌ WORKOUT PARSING VALIDATION FAILED:', errors);\r\n    return { valid: false, errors };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that hard days have hard workouts\r\n */\r\nexport function validateHardDays(weeks, qualityDays) {\r\n  if (!qualityDays || qualityDays.length === 0) return { valid: true };\r\n  \r\n  const errors = [];\r\n  \r\n  weeks.forEach(week => {\r\n    week.workouts.forEach(workout => {\r\n      if (qualityDays.includes(workout.day)) {\r\n        const descLower = (workout.description || '').toLowerCase();\r\n        const isHardWorkout = descLower.includes('tempo') || \r\n                             descLower.includes('interval') || \r\n                             descLower.includes('hill') ||\r\n                             descLower.includes('speed') ||\r\n                             workout.workoutType === 'tempo' ||\r\n                             workout.workoutType === 'interval' ||\r\n                             workout.workoutType === 'hill';\r\n        const isRest = descLower.includes('rest') || workout.type === 'rest';\r\n        const isEasy = descLower.includes('easy') && !isHardWorkout;\r\n        \r\n        if (isRest || (isEasy && !isHardWorkout)) {\r\n          errors.push(`Week ${week.weekNumber}: ${workout.day} is a hard day but has ${workout.description}`);\r\n        }\r\n      }\r\n    });\r\n  });\r\n  \r\n  if (errors.length > 0) {\r\n    console.error('❌ HARD DAYS VALIDATION FAILED:', errors);\r\n    return { valid: false, errors };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that rest days are actually rest\r\n */\r\nexport function validateRestDays(weeks, restDays) {\r\n  if (!restDays || restDays.length === 0) return { valid: true };\r\n  \r\n  const errors = [];\r\n  \r\n  weeks.forEach(week => {\r\n    week.workouts.forEach(workout => {\r\n      if (restDays.includes(workout.day)) {\r\n        const descLower = (workout.description || '').toLowerCase();\r\n        const isHardWorkout = descLower.includes('tempo') || \r\n                             descLower.includes('interval') || \r\n                             descLower.includes('hill') ||\r\n                             descLower.includes('speed');\r\n        const isRest = descLower.includes('rest') || workout.type === 'rest';\r\n        \r\n        if (isHardWorkout && !isRest) {\r\n          errors.push(`Week ${week.weekNumber}: ${workout.day} is a rest day but has hard workout: ${workout.description}`);\r\n        }\r\n      }\r\n    });\r\n  });\r\n  \r\n  if (errors.length > 0) {\r\n    console.error('❌ REST DAYS VALIDATION FAILED:', errors);\r\n    return { valid: false, errors };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that RunEQ miles are preserved (not converted to actual bike miles)\r\n */\r\nexport function validateRunEQMiles(weeks) {\r\n  const errors = [];\r\n  \r\n  weeks.forEach(week => {\r\n    week.workouts.forEach(workout => {\r\n      if (workout.type === 'bike' || (workout.description || '').toLowerCase().includes('runeq')) {\r\n        const desc = workout.description || '';\r\n        const hasRunEQ = desc.match(/runeq/i);\r\n        const hasActualMiles = desc.match(/\\d+\\s*(?:mile|miles).*cyclete/i) && !hasRunEQ;\r\n        \r\n        if (hasActualMiles) {\r\n          errors.push(`Week ${week.weekNumber}: ${workout.day} bike workout shows actual miles instead of RunEQ: ${desc}`);\r\n        }\r\n      }\r\n    });\r\n  });\r\n  \r\n  if (errors.length > 0) {\r\n    console.error('❌ RUNEQ MILES VALIDATION FAILED:', errors);\r\n    return { valid: false, errors };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that long runs show distance, not duration\r\n */\r\nexport function validateLongRunDistance(weeks) {\r\n  const errors = [];\r\n  \r\n  weeks.forEach(week => {\r\n    week.workouts.forEach(workout => {\r\n      if (workout.type === 'longRun' || (workout.description || '').toLowerCase().includes('long run')) {\r\n        const desc = workout.description || '';\r\n        const hasDuration = desc.match(/\\d+-\\d+\\s*(?:minutes?|min)/i);\r\n        const hasDistance = desc.match(/(\\d+(?:\\.\\d+)?)\\s*(?:miles?|mi)\\b/i);\r\n        \r\n        if (hasDuration && !hasDistance) {\r\n          errors.push(`Week ${week.weekNumber}: ${workout.day} long run shows duration instead of distance: ${desc}`);\r\n        }\r\n        \r\n        // Also check the distance property\r\n        if (!workout.distance || workout.distance === 0) {\r\n          errors.push(`Week ${week.weekNumber}: ${workout.day} long run missing distance property`);\r\n        }\r\n      }\r\n    });\r\n  });\r\n  \r\n  if (errors.length > 0) {\r\n    console.error('❌ LONG RUN DISTANCE VALIDATION FAILED:', errors);\r\n    return { valid: false, errors };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that Week 1 starts on the correct date\r\n */\r\nexport function validateWeek1StartDate(planOverview, expectedStartDate) {\r\n  if (!planOverview || !planOverview.startDate) {\r\n    return { valid: false, errors: ['Plan overview missing startDate'] };\r\n  }\r\n  \r\n  if (expectedStartDate && planOverview.startDate !== expectedStartDate) {\r\n    return { \r\n      valid: false, \r\n      errors: [`Week 1 start date mismatch: expected ${expectedStartDate}, got ${planOverview.startDate}`] \r\n    };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate that total weeks matches expected\r\n */\r\nexport function validateTotalWeeks(planOverview, expectedWeeks) {\r\n  if (!planOverview || !planOverview.totalWeeks) {\r\n    return { valid: false, errors: ['Plan overview missing totalWeeks'] };\r\n  }\r\n  \r\n  if (expectedWeeks && planOverview.totalWeeks !== expectedWeeks) {\r\n    return { \r\n      valid: false, \r\n      errors: [`Total weeks mismatch: expected ${expectedWeeks}, got ${planOverview.totalWeeks}`] \r\n    };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Run all validations\r\n */\r\nexport function validateTrainingPlan(plan, userProfile) {\r\n  const results = {\r\n    valid: true,\r\n    errors: []\r\n  };\r\n  \r\n  if (!plan || !plan.weeks) {\r\n    return { valid: false, errors: ['Plan or weeks missing'] };\r\n  }\r\n  \r\n  // Validate workouts parsed\r\n  const workoutsResult = validateWorkoutsParsed(plan.weeks);\r\n  if (!workoutsResult.valid) {\r\n    results.valid = false;\r\n    results.errors.push(...workoutsResult.errors);\r\n  }\r\n  \r\n  // Validate hard days\r\n  if (userProfile?.qualityDays) {\r\n    const hardDaysResult = validateHardDays(plan.weeks, userProfile.qualityDays);\r\n    if (!hardDaysResult.valid) {\r\n      results.valid = false;\r\n      results.errors.push(...hardDaysResult.errors);\r\n    }\r\n  }\r\n  \r\n  // Validate rest days\r\n  if (userProfile?.restDays) {\r\n    const restDaysResult = validateRestDays(plan.weeks, userProfile.restDays);\r\n    if (!restDaysResult.valid) {\r\n      results.valid = false;\r\n      results.errors.push(...restDaysResult.errors);\r\n    }\r\n  }\r\n  \r\n  // Validate RunEQ miles\r\n  const runEQResult = validateRunEQMiles(plan.weeks);\r\n  if (!runEQResult.valid) {\r\n    results.valid = false;\r\n    results.errors.push(...runEQResult.errors);\r\n  }\r\n  \r\n  // Validate long run distance\r\n  const longRunResult = validateLongRunDistance(plan.weeks);\r\n  if (!longRunResult.valid) {\r\n    results.valid = false;\r\n    results.errors.push(...longRunResult.errors);\r\n  }\r\n  \r\n  // Validate Week 1 start date\r\n  if (plan.planOverview && userProfile?.startDate) {\r\n    const startDateResult = validateWeek1StartDate(plan.planOverview, userProfile.startDate);\r\n    if (!startDateResult.valid) {\r\n      results.valid = false;\r\n      results.errors.push(...startDateResult.errors);\r\n    }\r\n  }\r\n  \r\n  // Validate total weeks\r\n  if (plan.planOverview && userProfile?.raceDate) {\r\n    const raceDate = new Date(userProfile.raceDate);\r\n    const startDate = new Date(userProfile.startDate || new Date());\r\n    const msPerWeek = 7 * 24 * 60 * 60 * 1000;\r\n    const expectedWeeks = Math.ceil((raceDate.getTime() - startDate.getTime()) / msPerWeek);\r\n    \r\n    const weeksResult = validateTotalWeeks(plan.planOverview, expectedWeeks);\r\n    if (!weeksResult.valid) {\r\n      results.valid = false;\r\n      results.errors.push(...weeksResult.errors);\r\n    }\r\n  }\r\n  \r\n  if (results.valid) {\r\n    console.log('✅ All training plan validations passed');\r\n  } else {\r\n    console.error('❌ Training plan validation failed:', results.errors);\r\n  }\r\n  \r\n  return results;\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":["validateTrainingPlan","plan","userProfile","results","valid","errors","weeks","workoutsResult","forEach","week","index","workouts","length","push","concat","weekNumber","console","error","validateWorkoutsParsed","qualityDays","hardDaysResult","workout","includes","day","descLower","description","toLowerCase","isHardWorkout","workoutType","isRest","type","isEasy","validateHardDays","restDays","restDaysResult","validateRestDays","runEQResult","desc","hasRunEQ","match","validateRunEQMiles","longRunResult","hasDuration","hasDistance","distance","validateLongRunDistance","planOverview","startDate","startDateResult","expectedStartDate","raceDate","Date","msPerWeek","expectedWeeks","Math","ceil","getTime","weeksResult","totalWeeks","validateTotalWeeks","log"],"sourceRoot":""}